# LaTeX 行内公式修复验证

## 问题描述
`\(a\)` 被错误渲染成 `$$`（空内容）

## 根本原因
在 `LatexMathInlineParser.cs` 中，`contentStart` 的计算错误：

### 修复前 ?
```csharp
slice.Start++;  // 跳过 '(' 后，slice.Start = 2
var contentStart = slice.Start + 1;  // contentStart = 3 ? 错误！
```

对于输入 `\(a\)`（索引 0,1,2,3,4）：
- 索引 0: `\`
- 索引 1: `(`
- 索引 2: `a` ← 应该从这里开始
- 索引 3: `\`
- 索引 4: `)`

但是 `contentStart = 3` 会从 `\` 开始，导致提取的内容为空或错误。

### 修复后 ?
```csharp
slice.Start++;  // 跳过 '(' 后，slice.Start = 2
var contentStart = slice.Start;  // contentStart = 2 ? 正确！
```

现在 `contentStart = 2` 正确指向 `a`。

## 测试用例

### 测试 1: 单个字符
输入: `\(a\)`
预期: 显示数学公式 "a"
实际: _______

### 测试 2: 单个变量
输入: `\(x\)`
预期: 显示数学公式 "x"
实际: _______

### 测试 3: 简单表达式
输入: `\(x + y\)`
预期: 显示数学公式 "x + y"
实际: _______

### 测试 4: 带上标
输入: `\(x^2\)`
预期: 显示数学公式 "x?"
实际: _______

### 测试 5: 希腊字母
输入: `\(\alpha\)`
预期: 显示数学公式 "α"
实际: _______

### 测试 6: 分数
输入: `\(\frac{a}{b}\)`
预期: 显示数学公式 "a/b"（分数形式）
实际: _______

### 测试 7: 复杂表达式
输入: `\(x^2 + y^2 = z^2\)`
预期: 显示数学公式完整的勾股定理
实际: _______

## 实际测试内容

### 基础测试

这是一个变量 \(a\) 在句子中。

这是另一个变量 \(b\) 在这里。

变量 \(x\) 和 \(y\) 都很重要。

### 表达式测试

简单加法：\(x + y\)

减法：\(a - b\)

乘法：\(xy\)

除法：\(x \div y\)

### 上下标测试

平方：\(x^2\)

立方：\(y^3\)

下标：\(x_i\)

组合：\(x_i^2\)

### 希腊字母测试

Alpha: \(\alpha\)

Beta: \(\beta\)

Gamma: \(\gamma\)

Delta: \(\Delta\)

Pi: \(\pi\)

### 函数测试

三角函数：\(\sin(x)\)

对数：\(\log(x)\)

极限：\(\lim_{x \to 0} f(x)\)

### 复杂表达式测试

勾股定理：\(x^2 + y^2 = z^2\)

二次公式：\(x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}\)

求和：\(\sum_{i=1}^{n} i = \frac{n(n+1)}{2}\)

积分：\(\int_0^1 x^2 dx = \frac{1}{3}\)

### 块级公式测试（对比）

行内：\(E = mc^2\)

块级：
\[
E = mc^2
\]

### 混合测试

爱因斯坦的质能方程 \(E = mc^2\) 表明能量 \(E\) 等于质量 \(m\) 乘以光速 \(c\) 的平方。

在数学中，我们经常使用变量 \(x\) 和 \(y\) 来表示未知数。对于二次方程 \(ax^2 + bx + c = 0\)，其解可以用求根公式计算。

圆的面积公式是 \(A = \pi r^2\)，其中 \(\pi \approx 3.14159\) 而 \(r\) 是半径。

## 验证清单

- [ ] 单字符 `\(a\)` 正确显示
- [ ] 变量 `\(x\)`, `\(y\)` 正确显示
- [ ] 简单表达式正确显示
- [ ] 上下标正确渲染
- [ ] 希腊字母正确显示
- [ ] 函数表达式正确显示
- [ ] 复杂公式正确渲染
- [ ] 不再显示 `$$` 或空内容
- [ ] 块级公式 `\[...\]` 仍然正常工作
- [ ] 混合使用行内和块级公式没有问题

## 修复总结

### 修改文件
- `Markdig.Wpf\Extensions\LatexMathInlineParser.cs`

### 关键改动
```diff
- var contentStart = slice.Start + 1;
+ var contentStart = slice.Start;
```

### 影响范围
- ? 修复 LaTeX 行内公式 `\(...\)` 的解析
- ? 不影响 LaTeX 块级公式 `\[...\]` 的解析
- ? 不影响 Markdown 风格公式 `$...$` 和 `$$...$$`
- ? 向后兼容，无破坏性变更

### 测试方法
1. 运行 `Markdig.Wpf.SampleApp`
2. 加载此文档
3. 检查所有行内公式是否正确显示
4. 特别关注单字符公式如 `\(a\)`, `\(x\)`

---

**修复状态**: ? 已完成并编译成功
**测试状态**: ? 待验证
